<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="../static/login/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/login/assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="../static/login/assets/css/style.css" rel="stylesheet">

    <title>Educational Bootstrap 5 Login Page Website Tampalte</title>
  </head>
  <body>
    <section class="form-02-main">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="_lk_de">
              <div class="form-03-main">
                <div class="logo">
                  <img src="../static/login/assets/images/user.png">
                </div>
                <form id="login-form">
                  <div class="form-group">
                    <input type="email" name="email" class="form-control _ge_de_ol" placeholder="Enter Email" required="" aria-required="true">
                  </div>
              
                  <div class="form-group">
                    <input type="password" name="password" class="form-control _ge_de_ol" placeholder="Enter Password" required="" aria-required="true">
                  </div>
              
                  <div class="checkbox form-group">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="" id="remember-me">
                      <label class="form-check-label" for="remember-me">
                        Remember me
                      </label>
                    </div>
                    <a href="#">Forgot Password</a>
                  </div>
              
                  <div class="form-group">
                    <button type="submit" class="_btn_04">Login</button>
                  </div>
              
                  <div class="form-group nm_lk"><a href="signUp.html">Or <span style="font-size: 18px; font-weight: 600; color: rgb(38, 38, 141);">Sign Up</span></a></div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>


    <script>

  document.getElementById('login-form').addEventListener('submit', async (event) => {
    event.preventDefault(); // Prevent the default form submission behavior

    const email = document.querySelector('input[name="email"]').value;
    const password = document.querySelector('input[name="password"]').value;

    // Create an object with the user's credentials
    const credentials = {
      email,
      password,
    };

    try {
      // Make an API call to your login endpoint
      const response = await fetch('http://localhost:8080/api/auth/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(credentials),
      });

      // if (response.ok) {
      //   // Redirect to index.html upon successful login
      //   window.location.href = 'index.html';
      // } else {
      //   // Handle login failure (e.g., show an error message)
      //   window.alert('Login failed. Please check your credentials.');
      // }

      // Assuming you have the response JSON data available
      const usersResponse = await fetch('http://localhost:8080/api/auth/getUsers');
      const usersData = await usersResponse.json();

      // Find the user with the entered email
      const userWithEmail = usersData.find(user => user.email === email);

      if (userWithEmail) {
        if(userWithEmail.roleId==1)
        {
        window.location.href = 'Admin/index.html';
        }
        else if(userWithEmail.roleId==2)
        {
        window.location.href = 'patient/index.html';
        }
        else
        {
        window.location.href = 'center/index.html';
        }
      } else {
        // Email not found, display a message
        window.alert('User not found. Please check your email.');
      }
    } catch (error) {
      console.error('An error occurred during login:', error);
    } finally {
      // Reset the form fields after submission
      document.querySelector('input[name="email"]').value = '';
      document.querySelector('input[name="password"]').value = '';
    }
  });



  // document.getElementById('login-form').addEventListener('submit', async (event) => {
  //   event.preventDefault(); // Prevent the default form submission behavior

  //   const email = document.querySelector('input[name="email"]').value;
  //   const password = document.querySelector('input[name="password"]').value;

  //   // Create an object with the user's credentials
  //   const credentials = {
  //     email,
  //     password,
  //   };

  //   try {
  //     // Make an API call to your login endpoint
  //     const response = await fetch('http://localhost:8080/api/auth/login', {
  //       method: 'POST',
  //       headers: {
  //         'Content-Type': 'application/json',
  //       },
  //       body: JSON.stringify(credentials),
  //     });

  //     if (response.ok) {
  //       // Redirect to index.html upon successful login
  //       window.location.href = 'index.html';
  //     } else {
  //       // Handle login failure (e.g., show an error message)
  //       window.alert('Login failed. Please check your credentials.');
  //     }
  //   } catch (error) {
  //     console.error('An error occurred during login:', error);
  //   }
  //   finally {
  //       // Reset the form fields after submission
  //       document.querySelector('input[name="email"]').value = '';
  //       document.querySelector('input[name="password"]').value = '';
  //   }
  // });

  
  </script>
  
  </body>
</html>